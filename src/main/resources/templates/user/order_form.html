<!-- order_form.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MGMG公式通信</title>
</head>
<body>
<h1>ご注文フォーム</h1>
<form th:action="@{/orders/confirm}" th:object="${orderForm}" method="post">
    <h2><strong>連絡先</strong></h2>
    <div>
        <label>メールアドレス：</label>
        <input type="email" th:field="*{email}" />
        <div th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
    </div>

    <h2><strong>お届け先</strong></h2>
    <div>
        <label>姓：</label>
        <input type="text" th:field="*{lastName}" />
        <div th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}"></div>
    </div>
    <div>
        <label>名：</label>
        <input type="text" th:field="*{firstName}" />
        <div th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}"></div>
    </div>
    <div>
        <label>郵便番号：</label>
        <input type="text" th:field="*{postcode}" />
        <div th:if="${#fields.hasErrors('postcode')}" th:errors="*{postcode}"></div>
    </div>
    <div>
        <label>住所：</label>
        <input type="text" th:field="*{address}" />
        <div th:if="${#fields.hasErrors('address')}" th:errors="*{address}"></div>
    </div>
    <div>
        <label>電話番号：</label>
        <input type="tel" th:field="*{tel}" />
        <div th:if="${#fields.hasErrors('tel')}" th:errors="*{tel}"></div>
    </div>

    <h2><strong>お支払い</strong></h2>
    <div>
        <label>カード番号：</label>
        <input type="text" th:field="*{cardNumber}" />
        <div th:if="${#fields.hasErrors('cardNumber')}" th:errors="*{cardNumber}"></div>
    </div>
    <div>
        <label>カード有効期限：</label>
        <input type="text" th:field="*{cardExpiry}" placeholder="MM/YY" />
        <div th:if="${#fields.hasErrors('cardExpiry')}" th:errors="*{cardExpiry}"></div>
    </div>
    <div>
        <label>セキュリティコード（CVV）：</label>
        <input type="text" th:field="*{cardCvv}" />
        <div th:if="${#fields.hasErrors('cardCvv')}" th:errors="*{cardCvv}"></div>
    </div>
    <div>
        <label>カード名義人：</label>
        <input type="text" th:field="*{cardHolderName}" />
        <div th:if="${#fields.hasErrors('cardHolderName')}" th:errors="*{cardHolderName}"></div>
    </div>

    <div style="text-align: center; margin-top: 20px;">
        <button type="submit" class="btn btn-primary">注文確認画面へ</button>
        <div style="margin-top: 10px;">
            <a th:href="@{/cart}" style="text-decoration: underline; color: #007bff;">← カートに戻る</a>
        </div>
    </div>
</form>

<!-- ▼ カート情報表示（右側に配置される想定） -->
<div>
    <h3>ご注文内容</h3>
    <div th:each="item : ${cartItems}">
        <div>
            <p>商品名: <span th:text="${item.product.name}"></span></p>
            <p>数量: <span th:text="${item.quantity}"></span></p>
            <p>金額: ¥<span th:text="${#numbers.formatDecimal(item.product.price, 1, 'COMMA', 2, 'POINT')}"></span></p>
            <hr>
        </div>
    </div>
    <p><strong>合計（税込）: ¥<span th:text="${totalPrice}"></span></strong></p>
</div>
</body>
</html>
